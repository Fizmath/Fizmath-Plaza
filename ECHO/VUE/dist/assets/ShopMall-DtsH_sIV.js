import{s as A}from"./index-BT3ELzeM.js";import{u as z,s as G,a as H,b as K,c as q,d as J,e as O,f as Y}from"./global-BHkMkod-.js";import{M as j,C as Q,L as _,E as W,D as c,G as y,P as X,o as Z,c as ee,a as u,z as o,A as r,H as k,I as w,J as x,K as te}from"./index-D4e0-Mkf.js";import"./index-BF6pbLUq.js";const oe={class:"card"},se={class:"flex flex-wrap gap-2 items-center justify-between"},ae=u("div",{class:"font-semibold text-xl mb-4"},"Purchase Products ",-1),re=u("i",{class:"pi pi-search"},null,-1),ue={__name:"ShopMall",setup(le){j(()=>{B()}),Q(()=>{$()});const n=z(),d=_([]),i=_([]),P=W(),f=c(),p=c(!1),S=c({}),b=c(),C=c(!1),m=c({global:{value:null,matchMode:te.CONTAINS}});function N(){S.value={},C.value=!1,p.value=!0}function g(e){if(e)return e.toLocaleString("en-US",{style:"currency",currency:"EUR"})}const I=e=>{var t=n.basket.findIndex(a=>a.id==e.id);n.basket.splice(t,1),P.add({severity:"success",summary:"Successful",detail:"Product Deleted from Basket",life:3e3})};function L(){f.value.exportCSV()}const $=()=>{y.get("/api/stores/products",{}).then(e=>{d.splice(0);for(var t=0;t<i.length;t++)d.push(...e.data.products.filter(a=>a.storeId===i[t].id))}).catch(e=>{alert(e)})},B=async()=>{await y.get("/api/stores",{}).then(e=>{i.splice(0);for(var t=0;t<e.data.stores.length;t++)e.data.stores[t].participating===!0&&i.push(e.data.stores[t])}).catch(e=>{alert(e)})},h=e=>{if(e){var t=i.filter(a=>a.id===e);return t[0].name+" from "+t[0].location}},D=e=>{if(e){var t=i.filter(a=>a.id===e);return t[0].name}};X(()=>{let e=i.map(t=>t.id);return console.log(e),d.filter(t=>t.storeId===newc.id)});const T=e=>{for(var t=0;t<n.basket.length;t++)if(n.basket[t].id==e.id)return!1;e.prodName=e.name,e.priceF=g(e.price),e.storNL=h(e.storeId),e.storN=D(e.storeId),e.quant=1,n.basket.push(e)};return(e,t)=>{const a=K,V=G,M=q,F=J,R=O,l=Y,v=H,U=A;return Z(),ee("div",null,[u("div",oe,[o(V,{class:"mb-6"},{start:r(()=>[o(a,{label:"Basket",severity:"danger",class:"mr-2",onClick:N,icon:"pi pi-cart-plus",outlined:"",badge:String(k(n).basket.length),badgeSeverity:"danger"},null,8,["badge"])]),end:r(()=>[o(a,{label:"Export",icon:"pi pi-upload",severity:"secondary",onClick:t[0]||(t[0]=s=>L(s))})]),_:1}),o(v,{ref_key:"dt",ref:f,selection:b.value,"onUpdate:selection":t[2]||(t[2]=s=>b.value=s),value:d,dataKey:"id",paginator:!0,rows:10,filters:m.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} products"},{header:r(()=>[u("div",se,[ae,o(R,null,{default:r(()=>[o(M,null,{default:r(()=>[re]),_:1}),o(F,{modelValue:m.value.global.value,"onUpdate:modelValue":t[1]||(t[1]=s=>m.value.global.value=s),placeholder:"Search..."},null,8,["modelValue"])]),_:1})])]),default:r(()=>[o(l,{field:"name",header:"Name",sortable:"",style:{"min-width":"12rem"}}),o(l,{field:"description",header:"Description",sortable:"",style:{"min-width":"16rem"}}),o(l,{field:"storeId",header:"Store",sortable:"",style:{"min-width":"16rem"}},{body:r(s=>[w(x(h(s.data.storeId)),1)]),_:1}),o(l,{field:"price",header:"Price",sortable:"",style:{"min-width":"8rem"}},{body:r(s=>[w(x(g(s.data.price)),1)]),_:1}),o(l,{exportable:!1,style:{"min-width":"12rem"}},{body:r(s=>[o(a,{icon:"pi pi-cart-plus",text:"",raised:"",rounded:"","aria-label":"Filter",onClick:E=>T(s.data)},null,8,["onClick"])]),_:1})]),_:1},8,["selection","value","filters"])]),o(U,{visible:p.value,"onUpdate:visible":t[3]||(t[3]=s=>p.value=s),header:"Your Basket",style:{width:"40vw"},maximizable:"",modal:"",contentStyle:{height:"300px"}},{default:r(()=>[o(v,{value:k(n).basket,scrollable:"",scrollHeight:"flex",tableStyle:"min-width: 50rem"},{default:r(()=>[o(l,{field:"prodName",header:"Name",style:{width:"5%"}}),o(l,{field:"storNL",header:"Store",style:{width:"10%"}}),o(l,{field:"priceF",header:"Price",style:{width:"5%"}}),o(l,{exportable:!1,style:{width:"5%"}},{body:r(s=>[o(a,{icon:"pi pi-times",severity:"danger",rounded:"",outlined:"","aria-label":"Cancel",onClick:E=>I(s.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value"])]),_:1},8,["visible"])])}}};export{ue as default};
